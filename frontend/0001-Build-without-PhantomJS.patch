From 4019b181746f8b1030a34c4a56d18236faddbdfd Mon Sep 17 00:00:00 2001
From: Edmunt Pienkowsky <roed@onet.eu>
Date: Wed, 26 Jun 2019 12:30:14 +0200
Subject: [PATCH 1/2] Build without PhantomJS

Signed-off-by: Edmunt Pienkowsky <roed@onet.eu>

diff --git a/package.json b/package.json
index ce9b36123..4b8071644 100644
--- a/package.json
+++ b/package.json
@@ -93,7 +93,6 @@
     "npm": "6.9.0",
     "optimize-css-assets-webpack-plugin": "5.0.1",
     "ora": "3.2.0",
-    "phantomjs-prebuilt": "2.1.16",
     "postcss-browser-reporter": "0.5.0",
     "postcss-loader": "3.0.0",
     "postcss-reporter": "6.0.1",
diff --git a/scripts/grunt/build_task.js b/scripts/grunt/build_task.js
index ca64c8d6f..41f9b679e 100644
--- a/scripts/grunt/build_task.js
+++ b/scripts/grunt/build_task.js
@@ -6,7 +6,6 @@ module.exports = function(grunt) {
   grunt.registerTask('build', [
     'clean:release',
     'clean:build',
-    'phantomjs',
     'exec:webpack',
   ]);
 
diff --git a/scripts/grunt/default_task.js b/scripts/grunt/default_task.js
index 7619ef860..a30bcbb77 100644
--- a/scripts/grunt/default_task.js
+++ b/scripts/grunt/default_task.js
@@ -5,7 +5,6 @@ module.exports = function(grunt) {
   // prettier-ignore
   grunt.registerTask('default', [
     'clean:build',
-    'phantomjs',
     'webpack:dev'
   ]);
 
diff --git a/scripts/grunt/options/phantomjs.js b/scripts/grunt/options/phantomjs.js
deleted file mode 100644
index 8c4e8dbd2..000000000
--- a/scripts/grunt/options/phantomjs.js
+++ /dev/null
@@ -1,37 +0,0 @@
-module.exports = function(config,grunt) {
-  'use strict';
-
-  grunt.registerTask('phantomjs', 'Copy phantomjs binary to vendor/', function() {
-
-    var dest = './tools/phantomjs/phantomjs';
-    var confDir = './node_modules/phantomjs-prebuilt/lib/';
-
-    if (process.platform === "win32") {
-      dest += ".exe";
-    }
-
-    src = config.phjs
-
-    if (!src){
-      var m=grunt.file.read(confDir+"location.js")
-      var src=/= \"([^\"]*)\"/.exec(m)[1];
-
-      if (!grunt.file.isPathAbsolute(src)) {
-        src = confDir+src;
-      }
-    }
-
-    try {
-      grunt.config('copy.phantom_bin', {
-        src: src,
-        dest: dest,
-        options: { mode: true},
-      });
-      grunt.task.run('copy:phantom_bin');
-    } catch (err) {
-      grunt.verbose.writeln(err);
-      grunt.fail.warn('No working Phantomjs binary available')
-    }
-
-  });
-};
diff --git a/scripts/grunt/release_task.js b/scripts/grunt/release_task.js
index f24ec6420..cb10bb6b8 100644
--- a/scripts/grunt/release_task.js
+++ b/scripts/grunt/release_task.js
@@ -33,7 +33,7 @@ module.exports = function(grunt) {
     });
     grunt.config('copy.backend_files', {
       expand: true,
-      src: ['conf/**', 'tools/phantomjs/*', 'scripts/*'],
+      src: ['conf/**', 'scripts/*'],
       options: { mode: true},
       dest: '<%= tempDir %>'
     });
-- 
2.22.0

